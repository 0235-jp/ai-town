// Map resizer script
// Usage: node data/resizeMap.js

import * as gentle from './gentle.js';

const NEW_WIDTH = 6;
const NEW_HEIGHT = 4;

// Slice arrays to new size
function sliceArray(arr, width, height) {
  return arr.slice(0, height).map(row => row.slice(0, width));
}

const newBgtiles = gentle.bgtiles.map(layer => sliceArray(layer, NEW_WIDTH, NEW_HEIGHT));
const newObjmap = sliceArray(gentle.objmap, NEW_WIDTH, NEW_HEIGHT);

// Format row
function formatRow(arr) {
  return `[ ${arr.join(' , ')} , ]`;
}

// Format 2D array
function format2DArray(arr) {
  return arr.map(row => formatRow(row)).join(',\n');
}

// Generate new file content
const output = `// Map generated by resizeMap.js [${new Date().toString()}]

export const tilesetpath = "${gentle.tilesetpath}"
export const tiledim = ${gentle.tiledim}
export const screenxtiles = ${NEW_WIDTH}
export const screenytiles = ${NEW_HEIGHT}
export const tilesetpxw = ${gentle.tilesetpxw}
export const tilesetpxh = ${gentle.tilesetpxh}

export const bgtiles = [
   [
${newBgtiles[0].map(row => formatRow(row)).join(',\n')},
],
[
${newBgtiles[1].map(row => formatRow(row)).join(',\n')},
],
]

export const objmap = [
${newObjmap.map(row => formatRow(row)).join(',\n')},
]
`;

console.log(output);
